/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2015 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

errno_t __cdecl j__wmakepath_s(wchar_t *PathResult, size_t SIZE, const wchar_t *Drive, const wchar_t *Dir, const wchar_t *Filename, const wchar_t *Ext);
int sub_411014(void); // weak
int __cdecl sub_41101E(_DWORD); // weak
int sub_411023(void); // weak
int __cdecl j__configthreadlocale(_DWORD); // weak
int __cdecl sub_411032(_DWORD); // weak
int j__get_initial_narrow_environment(void); // weak
int sub_41103C(void); // weak
int sub_411041(void); // weak
int sub_411046(void); // weak
int sub_411055(void); // weak
int start();
errno_t __cdecl j_wcscpy_s(wchar_t *Dst, rsize_t SizeInWords, const wchar_t *Src);
errno_t __cdecl j_strcpy_s(char *Dst, rsize_t SizeInBytes, const char *Src);
errno_t __cdecl j_strcat_s(char *Dst, rsize_t SizeInBytes, const char *Src);
int __cdecl sub_411073(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
_DWORD __cdecl sub_411078(_DWORD); // weak
int sub_41107D(void); // weak
int sub_411087(void); // weak
int sub_41108C(void); // weak
int __cdecl j__except_handler4_common(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int sub_4110A5(void); // weak
int sub_4110AF(void); // weak
_DWORD __cdecl sub_4110BE(_DWORD); // weak
int __cdecl sub_4110C3(_DWORD); // weak
void *__cdecl j_memset(void *Dst, int Val, size_t Size);
int sub_4110E6(void); // weak
int __cdecl sub_4110EB(int, char *Src); // idb
errno_t __cdecl j__set_fmode(int Mode);
int j___p__commode(void); // weak
int sub_41111D(void); // weak
int sub_411122(void); // weak
int __fastcall sub_411127(_DWORD, _DWORD); // weak
_DWORD __cdecl sub_41113B(_DWORD); // weak
LONG __stdcall TopLevelExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo); // idb
_DWORD __cdecl sub_41114F(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int __cdecl j___stdio_common_vsprintf_s(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int sub_411168(void); // weak
int sub_41118B(void); // weak
int __cdecl j__set_new_mode(_DWORD); // weak
int sub_41119A(); // weak
_DWORD __cdecl sub_41119F(_DWORD, _DWORD); // weak
int sub_4111A9(void); // weak
int __cdecl j__set_app_type(_DWORD); // weak
int __cdecl sub_4111CC(struct _EXCEPTION_POINTERS *ExceptionInfo); // idb
int j_nullsub_1(void); // weak
int sub_4111DB(void); // weak
int __cdecl j__initialize_onexit_table(_DWORD); // weak
_DWORD __cdecl sub_4111EA(_DWORD); // weak
int j__initialize_narrow_environment(void); // weak
int __cdecl sub_4111F9(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int sub_4111FE(void); // weak
int __cdecl sub_411203(_DWORD); // weak
int sub_41120D(void); // weak
int j_terminate(void); // weak
int sub_411217(void); // weak
int sub_411226(void); // weak
_DWORD __cdecl sub_41122B(_DWORD); // weak
errno_t __cdecl j__controlfp_s(unsigned int *CurrentState, unsigned int NewValue, unsigned int Mask);
int sub_411249(void); // weak
int sub_41124E(void); // weak
_DWORD __cdecl sub_411253(_DWORD); // weak
int __fastcall sub_411267(_DWORD, _DWORD); // weak
int __cdecl j___p___argc(_DWORD); // weak
int __cdecl j___p___argv(_DWORD); // weak
int __thiscall sub_41127B(_DWORD); // weak
int __cdecl j__register_onexit_function(_DWORD, _DWORD); // weak
int __cdecl sub_4112A3(_DWORD); // weak
errno_t __cdecl j__wsplitpath_s(const wchar_t *FullPath, wchar_t *Drive, size_t DriveSize, wchar_t *Dir, size_t DirSize, wchar_t *Filename, size_t FilenameSize, wchar_t *Ext, size_t ExtSize);
int __thiscall sub_4112D0(_DWORD); // weak
void __cdecl __noreturn j_exit(int Code);
int __cdecl j__configure_narrow_argv(_DWORD); // weak
_DWORD __cdecl sub_4112E9(_DWORD); // weak
int __cdecl j___setusermatherr(_DWORD); // weak
int __cdecl j___vcrt_GetModuleFileNameW(_DWORD, _DWORD, _DWORD); // weak
_DWORD __cdecl sub_4112FD(_DWORD); // weak
BOOL __stdcall j_IsProcessorFeaturePresent(DWORD ProcessorFeature);
int sub_411307(void); // weak
int __cdecl sub_41130C(_DWORD); // weak
_DWORD sub_411311(_DWORD, _DWORD, const char *, ...); // weak
int __cdecl j__crt_atexit(_DWORD); // weak
_DWORD __cdecl sub_411334(_DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD); // weak
int __cdecl sub_411348(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int sub_411352(void); // weak
int __cdecl j___vcrt_LoadLibraryExW(_DWORD, _DWORD, _DWORD); // weak
int sub_411366(void); // weak
int sub_41136B(void); // weak
int __cdecl j___vcrt_GetModuleHandleW(_DWORD); // weak
int sub_411375(void); // weak
_DWORD __cdecl sub_411384(_DWORD, _DWORD, _DWORD, _DWORD); // weak
_DWORD sub_411389(const char *, ...); // weak
_DWORD sub_411393(const char *, ...); // weak
_DWORD __cdecl sub_411398(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int __cdecl sub_4113A2(char *Str1); // idb
int __cdecl sub_4113A7(char *Str1); // idb
int __fastcall sub_4116F0(int a1, int a2);
int __cdecl sub_4117B0(char *Str1); // idb
int sub_411850();
int __fastcall sub_411A70(int a1, _DWORD *a2);
void *sub_411B60();
void sub_411B70();
int sub_411BB0();
int __cdecl SEH_4116F0(int a1, int a2, int a3, int a4);
int sub_411C00();
int sub_411CD0();
int sub_411CE0();
int sub_411D00();
int sub_411D20(void); // weak
int __cdecl sub_411F30(int a1, char a2);
int sub_411FB0();
int sub_411FD0();
int sub_411FE0();
int sub_412010();
int *sub_412030();
errno_t sub_412050();
int start_0();
bool __cdecl sub_412090(int a1);
bool __cdecl sub_4120E0(int a1, int a2, int a3, int a4);
int __cdecl sub_412140(int a1, int a2, int a3);
int __cdecl sub_412260(int a1, unsigned int a2);
int __cdecl sub_4122D0(int, char *Src); // idb
unsigned int __cdecl sub_4123B0(_BYTE *a1, _BYTE *a2, int a3, unsigned int a4);
unsigned int __cdecl sub_412440(const char *a1);
int __cdecl sub_412460(int, int, int, LPCSTR lpMultiByteStr); // idb
int __cdecl sub_412660(int a1, int a2, int a3, int a4);
void __cdecl sub_4126E0(ULONG_PTR *lpArguments);
void *sub_412860();
int __cdecl sub_412870(int a1, int a2, int a3, int a4, int a5);
int __cdecl sub_4128B0(int a1, int a2, int a3, char a4);
int __cdecl sub_4128E0(struct _EXCEPTION_POINTERS *ExceptionInfo); // idb
// int __usercall sub_412920@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, char a4);
// int __usercall sub_412A80@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, unsigned int a4);
int sub_412D00();
int sub_412D10();
int __cdecl sub_412D80(int a1);
int __cdecl sub_412DE0(int a1);
int __cdecl sub_412E10(int a1);
int __cdecl sub_412E50(int a1, char a2);
int __cdecl sub_412E60(int a1, unsigned int a2);
bool __cdecl sub_412F10(int a1);
unsigned __int32 sub_412FA0();
char sub_412FB0();
char __cdecl sub_4131A0(int a1);
char __cdecl sub_413200(int a1);
bool __cdecl sub_413320(int a1);
int __cdecl sub_4134A0(unsigned __int8 a1);
char __cdecl sub_4134D0(unsigned __int8 a1, char a2);
int __cdecl sub_413520(int a1);
signed int __cdecl sub_413610(int a1);
DWORD sub_413650();
DWORD sub_4136E0();
int sub_413780();
signed int sub_413790();
int sub_4137A0();
signed int sub_4137B0();
int sub_4137C0();
int sub_4137D0();
void sub_4137E0();
char sub_413820();
errno_t sub_413830();
void sub_413860();
void sub_413870();
void *sub_413880();
BOOL sub_4138E0();
void *sub_413910();
void *sub_413920();
// LONG __usercall sub_413930@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, unsigned int a4);
int sub_413B10();
bool sub_413B20();
LPTOP_LEVEL_EXCEPTION_FILTER sub_413BD0();
int __stdcall TopLevelExceptionFilter_0(_DWORD *a1);
void sub_413C70();
void *sub_413C90();
int __thiscall sub_413D10(void *this);
int sub_413D30();
int sub_413EC0();
int __cdecl sub_414140(int a1, char a2);
int __cdecl sub_4141E0(wchar_t *FullPath, wchar_t *PathResult, size_t SIZE); // idb
int __cdecl sub_4142F0(int a1, _WORD *a2, char a3, int *a4, int a5, int a6);
int sub_414640();
int sub_414710();
BOOL sub_414AA0();
void sub_414AD0();
int __cdecl sub_414AE0(int a1);
int __cdecl sub_414B00(int a1);
char sub_414CE0();
char sub_414CF0();
char sub_414D00();
char sub_414D10();
char sub_414D20();
int sub_414D30();
int __cdecl sub_414D40(char *Str1); // idb
int __cdecl sub_414EC0(int a1, int a2, int a3, int a4);
int __fastcall sub_414FF0(int a1, int a2);
// BOOL __stdcall IsDebuggerPresent();
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// SIZE_T __stdcall VirtualQuery(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength);
// HANDLE __stdcall GetProcessHeap();
// BOOL __stdcall HeapFree(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// DWORD __stdcall GetLastError();
// HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName);
// void __stdcall InitializeSListHead(PSLIST_HEADER ListHead);
// void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime);
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetCurrentProcessId();
// BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount);
// BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT uExitCode);
// HANDLE __stdcall GetCurrentProcess();
// LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo);
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCSTR lpDefaultChar, LPBOOL lpUsedDefaultChar);
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// int __cdecl puts(const char *Str);
// int __cdecl system(const char *Command);
// int __cdecl _stdio_common_vfscanf(_DWORD, _DWORD); weak
// int __cdecl _stdio_common_vfprintf(_DWORD, _DWORD); weak
// int __cdecl _acrt_iob_func(_DWORD); weak
// int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN sub_411181; // weak
_UNKNOWN j__CrtDbgReportW; // weak
int dword_4118CC = 1; // weak
int dword_4146F8 = 1; // weak
int dword_415150 = 1; // weak
LPCSTR lpMultiByteStr = "The value of ESP was not properly saved across a function call.  This is usually a result of calling a function declared with one calling convention with a function pointer declared with a different calling convention.\n\r"; // idb
int dword_417B74[] = { 1 }; // weak
struct _EXCEPTION_POINTERS ExceptionInfo = { &dword_41A158, &dword_41A1A8 }; // idb
_UNKNOWN unk_4188B4; // weak
_UNKNOWN unk_418AB8; // weak
char byte_41A000 = '\x01'; // weak
int __security_cookie = 3141592654; // weak
int dword_41A008 = 1153374641; // weak
int dword_41A010 = 1; // idb
int dword_41A018 = 1; // idb
int dword_41A020 = 1; // idb
int dword_41A02C = 1; // weak
int dword_41A030 = 1; // weak
int dword_41A034 = 1; // weak
char byte_41A140 = '\0'; // weak
_UNKNOWN unk_41A148; // weak
int dword_41A158 = 0; // weak
int dword_41A15C = 0; // weak
int dword_41A164 = 0; // weak
int dword_41A168 = 0; // weak
int dword_41A16C = 0; // weak
int dword_41A1A8 = 0; // weak
__int16 word_41A234; // weak
__int16 word_41A238; // weak
__int16 word_41A23C; // weak
__int16 word_41A240; // weak
int dword_41A244; // weak
int dword_41A248; // weak
int dword_41A24C; // weak
int dword_41A250; // weak
int dword_41A254; // weak
int dword_41A258; // weak
int dword_41A25C; // weak
int dword_41A260; // weak
__int16 word_41A264; // weak
int dword_41A268; // weak
int dword_41A26C; // weak
__int16 word_41A270; // weak
int dword_41A514; // weak
int dword_41A518; // weak
_UNKNOWN unk_41A524; // weak
int dword_41A528; // weak
int dword_41A52C; // weak
int dword_41A530; // weak
int dword_41A534; // weak
int dword_41A538; // weak
int dword_41A53C; // weak
char byte_41A540; // weak
char byte_41A541; // weak
union _SLIST_HEADER ListHead; // idb
_UNKNOWN unk_41A558; // weak
int dword_41A564; // weak
int dword_41A568; // weak
char byte_41A56C; // weak
char byte_41A56D; // weak
int dword_41A570; // weak
int dword_41A574; // weak
_UNKNOWN unk_41A57C; // weak
_UNKNOWN unk_41A588; // weak
int (__cdecl *__guard_check_icall_fptr)(_DWORD) = &sub_41128F; // weak


//----- (004116F0) --------------------------------------------------------
int __fastcall sub_4116F0(int a1, int a2)
{
  int savedregs; // [sp+E4h] [bp+0h]@1

  __debugbreak();
  return sub_411127((unsigned int)&savedregs ^ __security_cookie, a2);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);

//----- (004117B0) --------------------------------------------------------
int __cdecl sub_4117B0(char *Str1)
{
  int v1; // edx@1
  int v2; // ecx@1
  int v3; // edx@2
  int v4; // ecx@2
  char v6; // [sp+Ch] [bp-C0h]@1

  memset(&v6, 0xCCu, 0xC0u);
  strncmp(Str1, "Analy5is_is_Dru9", 0x11u);
  if ( sub_411127(v2, v1) )
    sub_411393("No No...");
  else
    sub_411375();
  return sub_411127(v4, v3);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 411375: using guessed type int sub_411375(void);
// 411393: using guessed type _DWORD sub_411393(const char *, ...);

//----- (00411850) --------------------------------------------------------
int sub_411850()
{
  int v0; // edx@1
  int v1; // ecx@1
  int v2; // edx@1
  int v3; // ecx@1
  char v5; // [sp+Ch] [bp-100h]@1
  char Str; // [sp+D0h] [bp-3Ch]@1
  unsigned int v7; // [sp+108h] [bp-4h]@1
  int savedregs; // [sp+10Ch] [bp+0h]@1

  memset(&v5, 0xCCu, 0x100u);
  v7 = (unsigned int)&savedregs ^ __security_cookie;
  qmemcpy(&Str, "you know searching string....\n but it is not answer", 0x34u);
  puts(&Str);
  sub_411127(v1, v0);
  sub_411267(&savedregs, &dword_4118CC);
  sub_41127B((unsigned int)&savedregs ^ v7);
  return sub_411127(v3, v2);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 411267: using guessed type int __fastcall sub_411267(_DWORD, _DWORD);
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 4118CC: using guessed type int dword_4118CC;

//----- (00411A70) --------------------------------------------------------
int __fastcall sub_411A70(int a1, _DWORD *a2)
{
  _DWORD *v2; // ebx@1
  int result; // eax@1
  int v4; // esi@1
  int v5; // edi@2
  int v6; // ecx@3
  int v7; // edx@3
  int v8; // [sp+8h] [bp-8h]@1
  int v9; // [sp+Ch] [bp-4h]@2
  int retaddr; // [sp+14h] [bp+4h]@5

  v2 = a2;
  result = a1;
  v4 = 0;
  v8 = a1;
  if ( *a2 > 0 )
  {
    v9 = a1 - 4;
    v5 = 0;
    do
    {
      v6 = v2[1];
      v7 = *(_DWORD *)(v6 + v5);
      if ( *(_DWORD *)(v7 + v9) != -858993460
        || (result = v7 + *(_DWORD *)(v6 + v5 + 4), *(_DWORD *)(result + v8) != -858993460) )
      {
        result = sub_4110EB(retaddr, *(char **)(v6 + v5 + 8));
      }
      ++v4;
      v5 += 12;
    }
    while ( v4 < *v2 );
  }
  return result;
}

//----- (00411AF0) --------------------------------------------------------
#error "411AF0: can not convert to microcode (funcsize=1)"

//----- (00411B30) --------------------------------------------------------
#error "411B36: can not convert to microcode (funcsize=2)"

//----- (00411B60) --------------------------------------------------------
void *sub_411B60()
{
  return &j__CrtDbgReportW;
}

//----- (00411B70) --------------------------------------------------------
void sub_411B70()
{
  int v0; // eax@2

  if ( !byte_41A140 )
  {
    byte_41A140 = 1;
    v0 = sub_411073(0, 0, 0, 1, 0);
    sub_4111EA(v0);
  }
}
// 411073: using guessed type int __cdecl sub_411073(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4111EA: using guessed type _DWORD __cdecl sub_4111EA(_DWORD);
// 41A140: using guessed type char byte_41A140;

//----- (00411BB0) --------------------------------------------------------
int sub_411BB0()
{
  return sub_411073(0, 0, 0, 1, 1);
}
// 411073: using guessed type int __cdecl sub_411073(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00411BD0) --------------------------------------------------------
int __cdecl SEH_4116F0(int a1, int a2, int a3, int a4)
{
  return j__except_handler4_common(&__security_cookie, sub_41127B, a1, a2, a3, a4);
}
// 411091: using guessed type int __cdecl j__except_handler4_common(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);

//----- (00411C00) --------------------------------------------------------
int sub_411C00()
{
  int v0; // eax@7

  sub_411366();
  sub_41103C();
  sub_411046();
  if ( !(unsigned __int8)sub_41122B(1) )
    sub_411078(7);
  __asm { fnclex }
  sub_4110E6();
  sub_4110BE(&sub_411181);
  if ( sub_41124E() )
    sub_411078(7);
  sub_41120D();
  if ( sub_41111D() )
    j___setusermatherr(sub_41119A);
  sub_41118B();
  sub_4111DB();
  sub_411055();
  v0 = sub_4110AF();
  j__configthreadlocale(v0);
  if ( (unsigned __int8)sub_41136B() )
    sub_411307();
  sub_4110A5();
  return 0;
}
// 41102D: using guessed type int __cdecl j__configthreadlocale(_DWORD);
// 41103C: using guessed type int sub_41103C(void);
// 411046: using guessed type int sub_411046(void);
// 411055: using guessed type int sub_411055(void);
// 411078: using guessed type _DWORD __cdecl sub_411078(_DWORD);
// 4110A5: using guessed type int sub_4110A5(void);
// 4110AF: using guessed type int sub_4110AF(void);
// 4110BE: using guessed type _DWORD __cdecl sub_4110BE(_DWORD);
// 4110E6: using guessed type int sub_4110E6(void);
// 41111D: using guessed type int sub_41111D(void);
// 41118B: using guessed type int sub_41118B(void);
// 41119A: using guessed type int sub_41119A();
// 4111DB: using guessed type int sub_4111DB(void);
// 41120D: using guessed type int sub_41120D(void);
// 41122B: using guessed type _DWORD __cdecl sub_41122B(_DWORD);
// 41124E: using guessed type int sub_41124E(void);
// 4112EE: using guessed type int __cdecl j___setusermatherr(_DWORD);
// 411307: using guessed type int sub_411307(void);
// 411366: using guessed type int sub_411366(void);
// 41136B: using guessed type int sub_41136B(void);

//----- (00411CD0) --------------------------------------------------------
int sub_411CD0()
{
  sub_411249();
  return 0;
}
// 411249: using guessed type int sub_411249(void);

//----- (00411CE0) --------------------------------------------------------
int sub_411CE0()
{
  int v0; // eax@1

  sub_411168();
  v0 = sub_4111A9();
  return j__set_new_mode(v0);
}
// 411168: using guessed type int sub_411168(void);
// 411195: using guessed type int __cdecl j__set_new_mode(_DWORD);
// 4111A9: using guessed type int sub_4111A9(void);

//----- (00411D00) --------------------------------------------------------
int sub_411D00()
{
  sub_4111FE();
  return sub_411D20();
}
// 4111FE: using guessed type int sub_4111FE(void);
// 411D20: using guessed type int sub_411D20(void);

//----- (00411D20) --------------------------------------------------------
#error "411F2B: positive sp value has been found (funcsize=126)"

//----- (00411F30) --------------------------------------------------------
int __cdecl sub_411F30(int a1, char a2)
{
  int v2; // edx@1
  int v3; // ecx@1
  int v4; // eax@1
  int v5; // edx@1
  int v6; // ecx@1
  char v8; // [sp+Ch] [bp-D8h]@1
  char *v9; // [sp+D0h] [bp-14h]@1

  memset(&v8, 0xCCu, 0xD8u);
  j_nullsub_1();
  v9 = &a2;
  _acrt_iob_func(1);
  v4 = sub_411127(v3, v2);
  sub_411384(v4, a1, 0, &a2);
  return sub_411127(v6, v5);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 4111D6: using guessed type int j_nullsub_1(void);
// 411384: using guessed type _DWORD __cdecl sub_411384(_DWORD, _DWORD, _DWORD, _DWORD);
// 41B17C: using guessed type int __cdecl _acrt_iob_func(_DWORD);

//----- (00411FB0) --------------------------------------------------------
int sub_411FB0()
{
  int v0; // eax@1

  v0 = sub_411014();
  return j__configure_narrow_argv(v0);
}
// 411014: using guessed type int sub_411014(void);
// 4112E4: using guessed type int __cdecl j__configure_narrow_argv(_DWORD);

//----- (00411FD0) --------------------------------------------------------
int sub_411FD0()
{
  return j__initialize_narrow_environment();
}
// 4111F4: using guessed type int j__initialize_narrow_environment(void);

//----- (00411FE0) --------------------------------------------------------
int sub_411FE0()
{
  int v0; // eax@1
  _DWORD *v1; // eax@1
  _DWORD *v2; // eax@1

  v0 = j__get_initial_narrow_environment();
  v1 = (_DWORD *)j___p___argv(v0);
  v2 = (_DWORD *)j___p___argc(*v1);
  return sub_4112A3(*v2);
}
// 411037: using guessed type int j__get_initial_narrow_environment(void);
// 411271: using guessed type int __cdecl j___p___argc(_DWORD);
// 411276: using guessed type int __cdecl j___p___argv(_DWORD);
// 4112A3: using guessed type int __cdecl sub_4112A3(_DWORD);

//----- (00412010) --------------------------------------------------------
int sub_412010()
{
  return j__set_app_type(1);
}
// 4111C2: using guessed type int __cdecl j__set_app_type(_DWORD);

//----- (00412030) --------------------------------------------------------
int *sub_412030()
{
  int v0; // esi@1
  int *result; // eax@1

  v0 = sub_41108C();
  result = (int *)j___p__commode();
  *result = v0;
  return result;
}
// 41108C: using guessed type int sub_41108C(void);
// 411118: using guessed type int j___p__commode(void);

//----- (00412050) --------------------------------------------------------
errno_t sub_412050()
{
  int v0; // eax@1

  v0 = sub_411352();
  return j__set_fmode(v0);
}
// 411352: using guessed type int sub_411352(void);

//----- (00412070) --------------------------------------------------------
int start_0()
{
  return sub_411D00();
}

//----- (00412090) --------------------------------------------------------
bool __cdecl sub_412090(int a1)
{
  ULONG_PTR Arguments; // [sp+0h] [bp-1Ch]@1
  int v3; // [sp+4h] [bp-18h]@1
  char *v4; // [sp+8h] [bp-14h]@1
  char v5; // [sp+1Bh] [bp-1h]@1

  v3 = a1;
  v4 = &v5;
  v5 = 0;
  Arguments = 4097;
  sub_4126E0(&Arguments);
  return v5 != 0;
}

//----- (004120E0) --------------------------------------------------------
bool __cdecl sub_4120E0(int a1, int a2, int a3, int a4)
{
  ULONG_PTR Arguments; // [sp+0h] [bp-1Ch]@1
  int v6; // [sp+4h] [bp-18h]@1
  int v7; // [sp+8h] [bp-14h]@1
  int v8; // [sp+Ch] [bp-10h]@1
  char *v9; // [sp+10h] [bp-Ch]@1
  int v10; // [sp+14h] [bp-8h]@1
  char v11; // [sp+1Bh] [bp-1h]@1

  v6 = a1;
  v7 = a2;
  v8 = a3;
  v9 = &v11;
  v10 = a4;
  v11 = 0;
  Arguments = 4098;
  sub_4126E0(&Arguments);
  return v11 != 0;
}

//----- (00412140) --------------------------------------------------------
int __cdecl sub_412140(int a1, int a2, int a3)
{
  int v3; // edi@1
  CHAR MultiByteStr; // [sp+Ch] [bp-140h]@4
  char v6; // [sp+100h] [bp-4Ch]@4
  char v7; // [sp+134h] [bp-18h]@4
  int v8; // [sp+148h] [bp-4h]@3
  int savedregs; // [sp+14Ch] [bp+0h]@3

  v3 = dword_41A020;
  if ( dword_41A020 != -1 )
  {
    if ( !a2 )
    {
      sub_412460(a1, dword_41A020, 4, "Stack area around _alloca memory reserved by this function is corrupted\n");
      return sub_41127B((unsigned int)&savedregs ^ v8);
    }
    sub_4123B0(&v7, &v6, a2 + 32, *(_DWORD *)(a2 + 12) - 36);
    sub_411311(
      &MultiByteStr,
      244,
      "%s%s%p%s%zd%s%d%s%s%s%s%s",
      "Stack area around _alloca memory reserved by this function is corrupted",
      "\nAddress: 0x",
      a2 + 32,
      "\nSize: ",
      *(_DWORD *)(a2 + 12) - 36,
      "\nAllocation number within this function: ",
      a3,
      "\nData: <",
      &v7,
      "> ",
      &v6,
      "\n");
    sub_412460(a1, v3, 4, &MultiByteStr);
  }
  return sub_41127B((unsigned int)&savedregs ^ v8);
}
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 411311: using guessed type _DWORD sub_411311(_DWORD, _DWORD, const char *, ...);

//----- (00412260) --------------------------------------------------------
int __cdecl sub_412260(int a1, unsigned int a2)
{
  int result; // eax@1
  int v3; // ecx@2

  result = a2;
  if ( a2 > 4 )
  {
    result = sub_412460(a1, 1, 5, "Unknown Runtime Check Error\n\r");
  }
  else
  {
    v3 = *(&dword_41A010 + a2);
    if ( v3 != -1 )
      result = sub_412460(a1, v3, a2, (&lpMultiByteStr)[4 * a2]);
  }
  return result;
}

//----- (004122D0) --------------------------------------------------------
int __cdecl sub_4122D0(int a1, char *Src)
{
  int v2; // edi@1
  char *v3; // eax@4
  char Dst; // [sp+Ch] [bp-404h]@4
  int v6; // [sp+40Ch] [bp-4h]@7
  int savedregs; // [sp+410h] [bp+0h]@7

  v2 = dword_41A018;
  if ( dword_41A018 != -1 )
  {
    if ( *Src && sub_412440(Src) + 45 <= 0x400 )
    {
      j_strcpy_s(&Dst, 0x400u, "Stack around the variable '");
      j_strcat_s(&Dst, 0x400u, Src);
      j_strcat_s(&Dst, 0x400u, "' was corrupted.");
      v3 = &Dst;
    }
    else
    {
      v3 = "Stack corrupted near unknown variable";
    }
    sub_412460(a1, v2, 2, v3);
  }
  return sub_41127B((unsigned int)&savedregs ^ v6);
}
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);

//----- (004123B0) --------------------------------------------------------
unsigned int __cdecl sub_4123B0(_BYTE *a1, _BYTE *a2, int a3, unsigned int a4)
{
  unsigned int v4; // ecx@1
  int v5; // edx@1
  _BYTE *v6; // esi@1
  int v7; // ebx@1
  _BYTE *v8; // edi@1
  unsigned int result; // eax@2
  char v10; // bl@5
  int v11; // [sp+Ch] [bp-8h]@2
  unsigned int v12; // [sp+10h] [bp-4h]@2
  int v13; // [sp+24h] [bp+10h]@1

  v4 = 0;
  v5 = 49;
  v6 = a1;
  v7 = a3 - (_DWORD)a1;
  v8 = a2;
  v13 = a3 - (_DWORD)a1;
  while ( 1 )
  {
    result = a4;
    v11 = v5;
    v12 = v4;
    if ( a4 >= 0x10 )
      result = 16;
    if ( v4 >= result )
      break;
    v10 = v6[v7];
    sub_411311(v8, v5, "%.2X ", v10);
    v4 = v12 + 1;
    *v6 = v10;
    v8 += 3;
    v7 = v13;
    ++v6;
    v5 = v11 - 3;
  }
  *v6 = 0;
  *v8 = 0;
  return result;
}
// 411311: using guessed type _DWORD sub_411311(_DWORD, _DWORD, const char *, ...);

//----- (00412440) --------------------------------------------------------
unsigned int __cdecl sub_412440(const char *a1)
{
  return strlen(a1);
}

//----- (00412460) --------------------------------------------------------
int __cdecl sub_412460(int a1, int a2, int a3, LPCSTR lpMultiByteStr)
{
  int (__cdecl *v4)(int, WCHAR *, int, WCHAR *, const wchar_t *, int, WCHAR *); // edi@1
  unsigned int v5; // eax@3
  WCHAR *v6; // ebx@4
  bool v7; // al@7
  int v8; // ST18_4@15
  int v9; // ST0C_4@15
  int v10; // eax@15
  CHAR *v11; // esi@16
  CHAR *v12; // edi@18
  int (__cdecl *v13)(int, CHAR *, int, CHAR *, const char *, int, LPCSTR); // ebx@20
  int v14; // ST18_4@20
  int v15; // ST0C_4@20
  int v17; // [sp+10h] [bp-E38h]@14
  int (__cdecl *v18)(int, CHAR *, int, CHAR *, const char *, int, LPCSTR); // [sp+14h] [bp-E34h]@1
  int v19; // [sp+18h] [bp-E30h]@1
  WCHAR WideCharStr; // [sp+1Ch] [bp-E2Ch]@4
  CHAR v21; // [sp+41Ch] [bp-A2Ch]@18
  CHAR MultiByteStr; // [sp+728h] [bp-720h]@16
  WCHAR v23; // [sp+A34h] [bp-414h]@14
  WCHAR v24; // [sp+C3Ch] [bp-20Ch]@14
  int v25; // [sp+E44h] [bp-4h]@23
  int savedregs; // [sp+E48h] [bp+0h]@23

  v19 = a3;
  v18 = 0;
  v4 = (int (__cdecl *)(int, WCHAR *, int, WCHAR *, const wchar_t *, int, WCHAR *))sub_4110C3(a1);
  if ( !v4 )
    v18 = (int (__cdecl *)(int, CHAR *, int, CHAR *, const char *, int, LPCSTR))sub_41130C(a1);
  v5 = MultiByteToWideChar(0xFDE9u, 0, lpMultiByteStr, -1, 0, 0);
  if ( v5 >= 0x200 || (v6 = &WideCharStr, !MultiByteToWideChar(0xFDE9u, 0, lpMultiByteStr, -1, &WideCharStr, v5)) )
    v6 = L"Runtime Check Error.\n\r Unable to display RTC Message.";
  if ( sub_412090(4098) )
  {
    v7 = sub_4120E0(v19, dword_417B74[v19], a1, (int)v6);
    if ( v7 )
      return sub_41127B((unsigned int)&savedregs ^ v25);
  }
  else
  {
    v7 = 1;
  }
  if ( !v18 && !v4 || v7 && IsDebuggerPresent() )
    goto LABEL_26;
  sub_411334(a1 - 5, &v24, 4, &v17, &v23, 260);
  if ( v4 )
  {
    v8 = v19;
    v9 = v17;
    sub_4112D0(v4);
    v10 = v4(a2, &v24, v9, &v23, L"Run-Time Check Failure #%d - %s", v8, v6);
  }
  else
  {
    v11 = "Unknown Filename";
    if ( WideCharToMultiByte(0xFDE9u, 0, &v24, -1, &MultiByteStr, 778, 0, 0) )
      v11 = &MultiByteStr;
    v12 = "Unknown Module Name";
    if ( WideCharToMultiByte(0xFDE9u, 0, &v23, -1, &v21, 778, 0, 0) )
      v12 = &v21;
    v13 = v18;
    v14 = v19;
    v15 = v17;
    sub_4112D0(v18);
    v10 = v13(a2, v11, v15, v12, "Run-Time Check Failure #%d - %s", v14, lpMultiByteStr);
  }
  if ( v10 == 1 )
LABEL_26:
    __debugbreak();
  return sub_41127B((unsigned int)&savedregs ^ v25);
}
// 4110C3: using guessed type int __cdecl sub_4110C3(_DWORD);
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 4112D0: using guessed type int __thiscall sub_4112D0(_DWORD);
// 41130C: using guessed type int __cdecl sub_41130C(_DWORD);
// 411334: using guessed type _DWORD __cdecl sub_411334(_DWORD, _DWORD, char, _DWORD, _DWORD, _DWORD);
// 417B74: using guessed type int dword_417B74[];
// 417F40: using guessed type wchar_t aRuntimeCheckEr[54];
// 417FC8: using guessed type wchar_t aRunTimeCheckFa[32];

//----- (00412660) --------------------------------------------------------
int __cdecl sub_412660(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int v5; // edx@1
  int v6; // ecx@1
  int v7; // edx@1
  int v8; // ecx@1
  char v10; // [sp+Ch] [bp-C0h]@1

  memset(&v10, 0xCCu, 0xC0u);
  v4 = sub_4111F9(a1, a2, a3, a4);
  _stdio_common_vfscanf(*(_DWORD *)v4, *(_DWORD *)(v4 + 4));
  sub_411127(v6, v5);
  return sub_411127(v8, v7);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 4111F9: using guessed type int __cdecl sub_4111F9(_DWORD, _DWORD, _DWORD, _DWORD);
// 41B174: using guessed type int __cdecl _stdio_common_vfscanf(_DWORD, _DWORD);

//----- (004126E0) --------------------------------------------------------
void __cdecl sub_4126E0(ULONG_PTR *lpArguments)
{
  RaiseException(0x406D1388u, 0, 6u, lpArguments);
}

//----- (00412860) --------------------------------------------------------
void *sub_412860()
{
  return &unk_41A148;
}

//----- (00412870) --------------------------------------------------------
#error "412873: call analysis failed (funcsize=17)"

//----- (004128B0) --------------------------------------------------------
int __cdecl sub_4128B0(int a1, int a2, int a3, char a4)
{
  j_nullsub_1();
  return sub_41114F(a1, a2, a3, 0, &a4);
}
// 41114F: using guessed type _DWORD __cdecl sub_41114F(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4111D6: using guessed type int j_nullsub_1(void);

//----- (004128E0) --------------------------------------------------------
BOOL __cdecl sub_4128E0(struct _EXCEPTION_POINTERS *ExceptionInfo)
{
  HANDLE v1; // eax@1

  SetUnhandledExceptionFilter(0);
  UnhandledExceptionFilter(ExceptionInfo);
  v1 = GetCurrentProcess();
  return TerminateProcess(v1, 0xC0000409);
}

//----- (00412920) --------------------------------------------------------
int __usercall sub_412920@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, char a4)
{
  int v4; // edx@1
  int v5; // ecx@1
  unsigned int v6; // et0@3
  int vars0; // [sp+324h] [bp+0h]@0
  int retaddr; // [sp+328h] [bp+4h]@3

  if ( j_IsProcessorFeaturePresent(0x17u) )
    __fastfail(2u);
  dword_41A258 = 0;
  dword_41A254 = v5;
  dword_41A250 = v4;
  dword_41A24C = a1;
  dword_41A248 = a3;
  dword_41A244 = a2;
  word_41A270 = __SS__;
  word_41A264 = __CS__;
  word_41A240 = __DS__;
  word_41A23C = __ES__;
  word_41A238 = __FS__;
  word_41A234 = __GS__;
  v6 = __readeflags();
  dword_41A268 = v6;
  dword_41A25C = vars0;
  dword_41A260 = retaddr;
  dword_41A26C = (int)&a4;
  dword_41A1A8 = 65537;
  dword_41A164 = retaddr;
  dword_41A158 = -1073740791;
  dword_41A15C = 1;
  dword_41A168 = 1;
  dword_41A16C = 2;
  return sub_4111CC(&ExceptionInfo);
}
// 41A158: using guessed type int dword_41A158;
// 41A15C: using guessed type int dword_41A15C;
// 41A164: using guessed type int dword_41A164;
// 41A168: using guessed type int dword_41A168;
// 41A16C: using guessed type int dword_41A16C;
// 41A1A8: using guessed type int dword_41A1A8;
// 41A234: using guessed type __int16 word_41A234;
// 41A238: using guessed type __int16 word_41A238;
// 41A23C: using guessed type __int16 word_41A23C;
// 41A240: using guessed type __int16 word_41A240;
// 41A244: using guessed type int dword_41A244;
// 41A248: using guessed type int dword_41A248;
// 41A24C: using guessed type int dword_41A24C;
// 41A250: using guessed type int dword_41A250;
// 41A254: using guessed type int dword_41A254;
// 41A258: using guessed type int dword_41A258;
// 41A25C: using guessed type int dword_41A25C;
// 41A260: using guessed type int dword_41A260;
// 41A264: using guessed type __int16 word_41A264;
// 41A268: using guessed type int dword_41A268;
// 41A26C: using guessed type int dword_41A26C;
// 41A270: using guessed type __int16 word_41A270;

//----- (00412A80) --------------------------------------------------------
int __usercall sub_412A80@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, unsigned int a4)
{
  int v4; // edx@1
  int v5; // ecx@1
  unsigned int v6; // et0@3
  int vars0; // [sp+31Ch] [bp+0h]@0
  int retaddr; // [sp+320h] [bp+4h]@3

  if ( j_IsProcessorFeaturePresent(0x17u) )
    __fastfail(a4);
  dword_41A258 = 0;
  dword_41A254 = v5;
  dword_41A250 = v4;
  dword_41A24C = a1;
  dword_41A248 = a3;
  dword_41A244 = a2;
  word_41A270 = __SS__;
  word_41A264 = __CS__;
  word_41A240 = __DS__;
  word_41A23C = __ES__;
  word_41A238 = __FS__;
  word_41A234 = __GS__;
  v6 = __readeflags();
  dword_41A268 = v6;
  dword_41A25C = vars0;
  dword_41A260 = retaddr;
  dword_41A26C = (int)&a4;
  dword_41A164 = retaddr;
  dword_41A158 = -1073740791;
  dword_41A15C = 1;
  dword_41A168 = 1;
  dword_41A16C = a4;
  return sub_4111CC(&ExceptionInfo);
}
// 41A158: using guessed type int dword_41A158;
// 41A15C: using guessed type int dword_41A15C;
// 41A164: using guessed type int dword_41A164;
// 41A168: using guessed type int dword_41A168;
// 41A16C: using guessed type int dword_41A16C;
// 41A234: using guessed type __int16 word_41A234;
// 41A238: using guessed type __int16 word_41A238;
// 41A23C: using guessed type __int16 word_41A23C;
// 41A240: using guessed type __int16 word_41A240;
// 41A244: using guessed type int dword_41A244;
// 41A248: using guessed type int dword_41A248;
// 41A24C: using guessed type int dword_41A24C;
// 41A250: using guessed type int dword_41A250;
// 41A254: using guessed type int dword_41A254;
// 41A258: using guessed type int dword_41A258;
// 41A25C: using guessed type int dword_41A25C;
// 41A260: using guessed type int dword_41A260;
// 41A264: using guessed type __int16 word_41A264;
// 41A268: using guessed type int dword_41A268;
// 41A26C: using guessed type int dword_41A26C;
// 41A270: using guessed type __int16 word_41A270;

//----- (00412D00) --------------------------------------------------------
int sub_412D00()
{
  return dword_41A514;
}
// 41A514: using guessed type int dword_41A514;

//----- (00412D10) --------------------------------------------------------
int sub_412D10()
{
  return dword_41A518;
}
// 41A518: using guessed type int dword_41A518;

//----- (00412D80) --------------------------------------------------------
int __cdecl sub_412D80(int a1)
{
  int result; // eax@1

  result = dword_41A518;
  dword_41A518 = a1;
  dword_41A514 = 0;
  return result;
}
// 41A514: using guessed type int dword_41A514;
// 41A518: using guessed type int dword_41A518;

//----- (00412DE0) --------------------------------------------------------
int __cdecl sub_412DE0(int a1)
{
  return sub_41119F(__security_cookie ^ a1, __security_cookie % 0x20u);
}
// 41119F: using guessed type _DWORD __cdecl sub_41119F(_DWORD, _DWORD);

//----- (00412E10) --------------------------------------------------------
int __cdecl sub_412E10(int a1)
{
  return __security_cookie ^ sub_41119F(a1, 32 - __security_cookie % 0x20u);
}
// 41119F: using guessed type _DWORD __cdecl sub_41119F(_DWORD, _DWORD);

//----- (00412E50) --------------------------------------------------------
int __cdecl sub_412E50(int a1, char a2)
{
  return __ROR4__(a1, a2);
}

//----- (00412E60) --------------------------------------------------------
int __cdecl sub_412E60(int a1, unsigned int a2)
{
  int v3; // [sp+10h] [bp-8h]@1
  int i; // [sp+14h] [bp-4h]@1

  v3 = *(_DWORD *)(a1 + 60) + a1;
  for ( i = v3 + *(_WORD *)(v3 + 20) + 24; i != v3 + *(_WORD *)(v3 + 20) + 24 + 40 * *(_WORD *)(v3 + 6); i += 40 )
  {
    if ( a2 >= *(_DWORD *)(i + 12) && a2 < *(_DWORD *)(i + 8) + *(_DWORD *)(i + 12) )
      return i;
  }
  return 0;
}

//----- (00412F10) --------------------------------------------------------
bool __cdecl sub_412F10(int a1)
{
  bool result; // al@2
  int v2; // [sp+8h] [bp-8h]@5

  if ( a1 )
  {
    if ( *(_WORD *)a1 == 23117 )
    {
      v2 = *(_DWORD *)(a1 + 60) + a1;
      if ( *(_DWORD *)v2 == 17744 )
        result = *(_WORD *)(v2 + 24) == 267;
      else
        result = 0;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00412FA0) --------------------------------------------------------
unsigned __int32 sub_412FA0()
{
  return __readfsdword(24);
}

//----- (00412FB0) --------------------------------------------------------
char sub_412FB0()
{
  char result; // al@2
  signed __int32 v1; // [sp+0h] [bp-8h]@4
  signed __int32 v2; // [sp+4h] [bp-4h]@3

  if ( sub_41107D() )
  {
    v2 = *(_DWORD *)(sub_411087() + 4);
    while ( 1 )
    {
      v1 = _InterlockedCompareExchange((volatile signed __int32 *)&unk_41A524, v2, 0);
      if ( !v1 )
        break;
      if ( v2 == v1 )
        return 1;
    }
    result = 0;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 41107D: using guessed type int sub_41107D(void);
// 411087: using guessed type int sub_411087(void);

//----- (004131A0) --------------------------------------------------------
char __cdecl sub_4131A0(int a1)
{
  char result; // al@4

  if ( !a1 )
    byte_41A541 = 1;
  sub_411122();
  if ( (unsigned __int8)sub_411226() )
  {
    if ( (unsigned __int8)sub_411023() )
    {
      result = 1;
    }
    else
    {
      sub_411203(0);
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 411023: using guessed type int sub_411023(void);
// 411122: using guessed type int sub_411122(void);
// 411203: using guessed type int __cdecl sub_411203(_DWORD);
// 411226: using guessed type int sub_411226(void);
// 41A541: using guessed type char byte_41A541;

//----- (00413200) --------------------------------------------------------
char __cdecl sub_413200(int a1)
{
  if ( byte_41A540 )
    return 1;
  if ( a1 && a1 != 1 )
    sub_411078(5);
  if ( !sub_41107D() || a1 )
  {
    dword_41A528 = sub_4112FD(-1);
    dword_41A52C = dword_41A528;
    dword_41A530 = dword_41A528;
    dword_41A534 = dword_41A528;
    dword_41A538 = dword_41A528;
    dword_41A53C = dword_41A528;
  }
  else
  {
    if ( j__initialize_onexit_table(&dword_41A528) )
      return 0;
    if ( j__initialize_onexit_table(&dword_41A534) )
      return 0;
  }
  byte_41A540 = 1;
  return 1;
}
// 411078: using guessed type _DWORD __cdecl sub_411078(_DWORD);
// 41107D: using guessed type int sub_41107D(void);
// 4111E0: using guessed type int __cdecl j__initialize_onexit_table(_DWORD);
// 4112FD: using guessed type _DWORD __cdecl sub_4112FD(_DWORD);
// 41A528: using guessed type int dword_41A528;
// 41A52C: using guessed type int dword_41A52C;
// 41A530: using guessed type int dword_41A530;
// 41A534: using guessed type int dword_41A534;
// 41A538: using guessed type int dword_41A538;
// 41A53C: using guessed type int dword_41A53C;
// 41A540: using guessed type char byte_41A540;

//----- (00413320) --------------------------------------------------------
bool __cdecl sub_413320(int a1)
{
  bool result; // al@2
  int v2; // [sp+20h] [bp-28h]@3

  if ( sub_412F10(0x400000) )
  {
    v2 = sub_412E60(0x400000, a1 - 0x400000);
    if ( v2 )
      result = (*(_DWORD *)(v2 + 36) & 0x80000000) == 0;
    else
      result = 0;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004134A0) --------------------------------------------------------
int __cdecl sub_4134A0(unsigned __int8 a1)
{
  int result; // eax@1

  result = sub_41107D();
  if ( result )
  {
    result = a1;
    if ( !a1 )
      _InterlockedExchange((volatile signed __int32 *)&unk_41A524, 0);
  }
  return result;
}
// 41107D: using guessed type int sub_41107D(void);

//----- (004134D0) --------------------------------------------------------
char __cdecl sub_4134D0(unsigned __int8 a1, char a2)
{
  char result; // al@3

  if ( byte_41A541 && a2 )
  {
    result = 1;
  }
  else
  {
    sub_41101E(a1);
    sub_411203(a1);
    result = 1;
  }
  return result;
}
// 41101E: using guessed type int __cdecl sub_41101E(_DWORD);
// 411203: using guessed type int __cdecl sub_411203(_DWORD);
// 41A541: using guessed type char byte_41A541;

//----- (00413520) --------------------------------------------------------
int __cdecl sub_413520(int a1)
{
  int result; // eax@5
  int v2; // [sp+4h] [bp-8h]@7
  int v3; // [sp+8h] [bp-4h]@3

  if ( sub_41113B(dword_41A528) == -1 )
  {
    if ( j__crt_atexit(a1) )
      v3 = 0;
    else
      v3 = a1;
    result = v3;
  }
  else
  {
    if ( j__register_onexit_function(&dword_41A528, a1) )
      v2 = 0;
    else
      v2 = a1;
    result = v2;
  }
  return result;
}
// 41113B: using guessed type _DWORD __cdecl sub_41113B(_DWORD);
// 411285: using guessed type int __cdecl j__register_onexit_function(_DWORD, _DWORD);
// 41132F: using guessed type int __cdecl j__crt_atexit(_DWORD);
// 41A528: using guessed type int dword_41A528;

//----- (00413610) --------------------------------------------------------
signed int __cdecl sub_413610(int a1)
{
  signed int v2; // [sp+0h] [bp-4h]@2

  if ( sub_411253(a1) )
    v2 = 0;
  else
    v2 = -1;
  return v2;
}
// 411253: using guessed type _DWORD __cdecl sub_411253(_DWORD);

//----- (00413650) --------------------------------------------------------
DWORD sub_413650()
{
  LARGE_INTEGER PerformanceCount; // [sp+0h] [bp-14h]@1
  struct _FILETIME SystemTimeAsFileTime; // [sp+8h] [bp-Ch]@1
  DWORD v3; // [sp+10h] [bp-4h]@1

  SystemTimeAsFileTime.dwLowDateTime = 0;
  SystemTimeAsFileTime.dwHighDateTime = 0;
  GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
  v3 = SystemTimeAsFileTime.dwHighDateTime ^ SystemTimeAsFileTime.dwLowDateTime;
  v3 ^= GetCurrentThreadId();
  v3 ^= GetCurrentProcessId();
  QueryPerformanceCounter(&PerformanceCount);
  return (unsigned int)&v3 ^ PerformanceCount.HighPart ^ PerformanceCount.LowPart ^ v3;
}

//----- (004136E0) --------------------------------------------------------
DWORD sub_4136E0()
{
  DWORD result; // eax@2
  signed int v1; // [sp+0h] [bp-4h]@4

  if ( __security_cookie != -1153374642 && (result = __security_cookie & 0xFFFF0000) != 0 )
  {
    dword_41A008 = ~__security_cookie;
  }
  else
  {
    result = sub_413650();
    v1 = result;
    if ( result == -1153374642 )
    {
      v1 = -1153374641;
    }
    else if ( !(result & 0xFFFF0000) )
    {
      result |= (result | 0x4711) << 16;
      v1 |= (v1 | 0x4711) << 16;
    }
    __security_cookie = v1;
    dword_41A008 = ~v1;
  }
  return result;
}
// 41A008: using guessed type int dword_41A008;

//----- (00413780) --------------------------------------------------------
int sub_413780()
{
  return 0;
}

//----- (00413790) --------------------------------------------------------
signed int sub_413790()
{
  return 1;
}

//----- (004137A0) --------------------------------------------------------
int sub_4137A0()
{
  return 0;
}

//----- (004137B0) --------------------------------------------------------
signed int sub_4137B0()
{
  return 0x4000;
}

//----- (004137C0) --------------------------------------------------------
int sub_4137C0()
{
  return 0;
}

//----- (004137D0) --------------------------------------------------------
int sub_4137D0()
{
  return 0;
}

//----- (004137E0) --------------------------------------------------------
void sub_4137E0()
{
  InitializeSListHead(&ListHead);
}

//----- (00413820) --------------------------------------------------------
char sub_413820()
{
  return 1;
}

//----- (00413830) --------------------------------------------------------
errno_t sub_413830()
{
  errno_t result; // eax@1

  result = j__controlfp_s(0, 0x10000u, 0x30000u);
  if ( result )
    result = sub_411078(7);
  return result;
}
// 411078: using guessed type _DWORD __cdecl sub_411078(_DWORD);

//----- (00413860) --------------------------------------------------------
void sub_413860()
{
  ;
}

//----- (00413870) --------------------------------------------------------
void sub_413870()
{
  ;
}

//----- (00413880) --------------------------------------------------------
void *sub_413880()
{
  return &unk_41A558;
}

//----- (00413890) --------------------------------------------------------
#error "4138B1: call analysis failed (funcsize=24)"

//----- (004138E0) --------------------------------------------------------
BOOL sub_4138E0()
{
  return dword_41A02C == 0;
}
// 41A02C: using guessed type int dword_41A02C;

//----- (00413910) --------------------------------------------------------
void *sub_413910()
{
  return &unk_41A588;
}

//----- (00413920) --------------------------------------------------------
void *sub_413920()
{
  return &unk_41A57C;
}

//----- (00413930) --------------------------------------------------------
LONG __usercall sub_413930@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, unsigned int a4)
{
  void *v4; // eax@3
  int v5; // ecx@3
  int v6; // edx@3
  unsigned int v7; // et0@3
  LONG result; // eax@3
  int Dst; // [sp+0h] [bp-32Ch]@3
  __int16 v10; // [sp+8Ch] [bp-2A0h]@3
  __int16 v11; // [sp+90h] [bp-29Ch]@3
  __int16 v12; // [sp+94h] [bp-298h]@3
  __int16 v13; // [sp+98h] [bp-294h]@3
  int v14; // [sp+9Ch] [bp-290h]@3
  int v15; // [sp+A0h] [bp-28Ch]@3
  int v16; // [sp+A4h] [bp-288h]@3
  int v17; // [sp+A8h] [bp-284h]@3
  int v18; // [sp+ACh] [bp-280h]@3
  void *v19; // [sp+B0h] [bp-27Ch]@3
  int v20; // [sp+B4h] [bp-278h]@3
  int v21; // [sp+B8h] [bp-274h]@3
  __int16 v22; // [sp+BCh] [bp-270h]@3
  unsigned int v23; // [sp+C0h] [bp-26Ch]@3
  void **v24; // [sp+C4h] [bp-268h]@3
  __int16 v25; // [sp+C8h] [bp-264h]@3
  int v26; // [sp+2CCh] [bp-60h]@3
  int v27; // [sp+2D0h] [bp-5Ch]@3
  int v28; // [sp+2D8h] [bp-54h]@3
  struct _EXCEPTION_POINTERS ExceptionInfo; // [sp+31Ch] [bp-10h]@3
  LONG v30; // [sp+324h] [bp-8h]@3
  bool v31; // [sp+32Ah] [bp-2h]@3
  bool v32; // [sp+32Bh] [bp-1h]@3
  int savedregs; // [sp+32Ch] [bp+0h]@3
  int retaddr; // [sp+330h] [bp+4h]@3

  if ( j_IsProcessorFeaturePresent(0x17u) )
    __fastfail(a4);
  sub_411032(3);
  v4 = j_memset(&Dst, 0, 0x2CCu);
  v19 = v4;
  v18 = v5;
  v17 = v6;
  v16 = a1;
  v15 = a3;
  v14 = a2;
  v25 = __SS__;
  v22 = __CS__;
  v13 = __DS__;
  v12 = __ES__;
  v11 = __FS__;
  v10 = __GS__;
  v7 = __readeflags();
  v23 = v7;
  Dst = 65537;
  v21 = retaddr;
  v24 = (void **)&retaddr;
  v20 = savedregs;
  j_memset(&v26, 0, 0x50u);
  v26 = 1073741845;
  v27 = 1;
  v28 = retaddr;
  v32 = IsDebuggerPresent() == 1;
  v31 = v32;
  ExceptionInfo.ExceptionRecord = (PEXCEPTION_RECORD)&v26;
  ExceptionInfo.ContextRecord = (PCONTEXT)&Dst;
  SetUnhandledExceptionFilter(0);
  result = UnhandledExceptionFilter(&ExceptionInfo);
  v30 = result;
  if ( !result && !v31 )
    result = sub_411032(3);
  return result;
}
// 411032: using guessed type int __cdecl sub_411032(_DWORD);

//----- (00413B10) --------------------------------------------------------
int sub_413B10()
{
  return 0;
}

//----- (00413B20) --------------------------------------------------------
bool sub_413B20()
{
  bool result; // al@2
  int v1; // [sp+0h] [bp-8h]@5
  HMODULE v2; // [sp+4h] [bp-4h]@1

  v2 = GetModuleHandleW(0);
  if ( v2 )
  {
    if ( *(_WORD *)v2 == 23117 )
    {
      v1 = (int)v2 + *((_DWORD *)v2 + 15);
      if ( *(_DWORD *)v1 == 17744 )
      {
        if ( *(_WORD *)(v1 + 24) == 267 )
        {
          if ( *(_DWORD *)(v1 + 116) > 0xEu )
            result = *(_DWORD *)(v1 + 232) != 0;
          else
            result = 0;
        }
        else
        {
          result = 0;
        }
      }
      else
      {
        result = 0;
      }
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00413BD0) --------------------------------------------------------
LPTOP_LEVEL_EXCEPTION_FILTER sub_413BD0()
{
  return SetUnhandledExceptionFilter(TopLevelExceptionFilter);
}

//----- (00413BF0) --------------------------------------------------------
int __stdcall TopLevelExceptionFilter_0(_DWORD *a1)
{
  _DWORD *v2; // [sp+0h] [bp-4h]@1

  v2 = (_DWORD *)*a1;
  if ( *(_DWORD *)*a1 == -529697949
    && v2[4] == 3
    && (v2[5] == 429065504 || v2[5] == 429065505 || v2[5] == 429065506 || v2[5] == 26820608) )
  {
    j_terminate();
  }
  return 0;
}
// 411212: using guessed type int j_terminate(void);

//----- (00413C70) --------------------------------------------------------
void sub_413C70()
{
  dword_41A564 = 0;
}
// 41A564: using guessed type int dword_41A564;

//----- (00413C90) --------------------------------------------------------
void *sub_413C90()
{
  int (**v0)(void); // esi@1
  void *result; // eax@1
  int (*v2)(void); // edi@2

  v0 = (int (**)(void))&unk_4188B4;
  result = &unk_4188B4;
  if ( &unk_4188B4 < &unk_418AB8 )
  {
    do
    {
      v2 = *v0;
      if ( *v0 )
      {
        sub_4112D0(*v0);
        result = (void *)v2();
      }
      ++v0;
    }
    while ( v0 < (int (**)(void))&unk_418AB8 );
  }
  return result;
}
// 4112D0: using guessed type int __thiscall sub_4112D0(_DWORD);

//----- (00413D10) --------------------------------------------------------
int __thiscall sub_413D10(void *this)
{
  return __guard_check_icall_fptr(this);
}
// 41C000: using guessed type int (__cdecl *__guard_check_icall_fptr)(_DWORD);

//----- (00413D30) --------------------------------------------------------
int sub_413D30()
{
  int v0; // eax@3
  wchar_t FullPath; // [sp+0h] [bp-414h]@4
  wchar_t PathResult; // [sp+208h] [bp-20Ch]@5
  int v4; // [sp+410h] [bp-4h]@14
  int savedregs; // [sp+414h] [bp+0h]@14

  if ( !byte_41A56C )
  {
    byte_41A56C = 1;
    if ( !sub_413EC0() )
    {
      v0 = j___vcrt_GetModuleHandleW(L"VCRUNTIME140D.dll");
      if ( (!v0
         || !j___vcrt_GetModuleFileNameW(v0, &FullPath, 260)
         || !sub_4141E0(&FullPath, &PathResult, 0x104u)
         || !j___vcrt_LoadLibraryExW(&PathResult, 0, 2304)
         && (GetLastError() != 87 || !j___vcrt_LoadLibraryExW(&PathResult, 0, 8)))
        && !j___vcrt_LoadLibraryExW(L"MSPDB140", 0, 2560)
        && GetLastError() == 87
        && j___vcrt_GetModuleFileNameW(0, &FullPath, 260)
        && sub_4141E0(&FullPath, &PathResult, 0x104u) )
      {
        j___vcrt_LoadLibraryExW(&PathResult, 0, 8);
      }
    }
  }
  return sub_41127B((unsigned int)&savedregs ^ v4);
}
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 4112F3: using guessed type int __cdecl j___vcrt_GetModuleFileNameW(_DWORD, _DWORD, _DWORD);
// 41135C: using guessed type int __cdecl j___vcrt_LoadLibraryExW(_DWORD, _DWORD, _DWORD);
// 411370: using guessed type int __cdecl j___vcrt_GetModuleHandleW(_DWORD);
// 41832C: using guessed type wchar_t aVcruntime140d_[18];
// 4184DC: using guessed type wchar_t aMspdb140[9];
// 41A56C: using guessed type char byte_41A56C;

//----- (00413EC0) --------------------------------------------------------
int sub_413EC0()
{
  HMODULE v0; // edi@1
  FARPROC v2; // esi@6
  FARPROC v3; // ebx@8
  int v4; // ST00_4@13
  int v5; // eax@13
  int v6; // ST14_4@13
  void (__stdcall *v7)(int); // ebx@13
  int v8; // esi@13
  unsigned int v9; // edx@16
  unsigned int v10; // ecx@17
  char *v11; // eax@17
  int v12; // [sp+4h] [bp-21Ch]@13
  FARPROC v13; // [sp+8h] [bp-218h]@9
  unsigned int v14; // [sp+Ch] [bp-214h]@13
  int v15; // [sp+10h] [bp-210h]@10
  int v16; // [sp+14h] [bp-20Ch]@13
  int v17; // [sp+18h] [bp-208h]@22
  int v18; // [sp+1Ch] [bp-204h]@22
  int v19; // [sp+20h] [bp-200h]@22
  int v20; // [sp+24h] [bp-1FCh]@22
  int v21; // [sp+28h] [bp-1F8h]@22
  int v22; // [sp+2Ch] [bp-1F4h]@22
  int v23; // [sp+30h] [bp-1F0h]@22
  __int16 v24[244]; // [sp+34h] [bp-1ECh]@22
  int v25; // [sp+21Ch] [bp-4h]@5
  int savedregs; // [sp+220h] [bp+0h]@5

  v0 = (HMODULE)j___vcrt_LoadLibraryExW(L"api-ms-win-core-registry-l1-1-0.dll", 0, 2048);
  if ( !v0 )
  {
    v0 = (HMODULE)j___vcrt_LoadLibraryExW(L"advapi32.dll", 0, 2048);
    if ( !v0 )
    {
      if ( GetLastError() != 87 )
        return sub_41127B((unsigned int)&savedregs ^ v25);
      v0 = (HMODULE)j___vcrt_LoadLibraryExW(L"advapi32.dll", 0, 0);
      if ( !v0 )
        return sub_41127B((unsigned int)&savedregs ^ v25);
    }
  }
  v2 = GetProcAddress(v0, "RegOpenKeyExW");
  if ( !v2 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  v3 = GetProcAddress(v0, "RegQueryValueExW");
  if ( !v3 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  v13 = GetProcAddress(v0, "RegCloseKey");
  if ( !v13 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  sub_4112D0(v2);
  if ( ((int (__stdcall *)(signed int, const wchar_t *, _DWORD, signed int, int *))v2)(
         -2147483646,
         L"SOFTWARE\\Wow6432Node\\Microsoft\\VisualStudio\\14.0\\Setup\\VC",
         0,
         1,
         &v15) )
  {
    FreeLibrary(v0);
    return sub_41127B((unsigned int)&savedregs ^ v25);
  }
  v14 = 520;
  v4 = v15;
  sub_4112D0(v3);
  v5 = ((int (__stdcall *)(int, const wchar_t *, _DWORD, int *, int *, unsigned int *))v3)(
         v4,
         L"ProductDir",
         0,
         &v12,
         &v16,
         &v14);
  v6 = v15;
  v7 = (void (__stdcall *)(int))v13;
  v8 = v5;
  sub_4112D0(v13);
  v7(v6);
  FreeLibrary(v0);
  if ( v8 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  if ( v12 != 1 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  if ( v14 & 1 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  v9 = v14 >> 1;
  if ( v14 >> 1 < 2 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  v10 = (v14 >> 1) - 1;
  v11 = (char *)&v16 + 2 * v10;
  if ( *((_WORD *)&v16 + v10) )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  if ( *((_WORD *)v11 - 1) != 92 )
  {
    *(_WORD *)v11 = 92;
    v10 = v9;
  }
  if ( ~v10 < 0x12 || v10 + 17 > 0x104 )
    return sub_41127B((unsigned int)&savedregs ^ v25);
  *(int *)((char *)&v16 + 2 * v10) = 6881378;
  *(int *)((char *)&v17 + 2 * v10) = 6029422;
  *(int *)((char *)&v18 + 2 * v10) = 5439565;
  *(int *)((char *)&v19 + 2 * v10) = 4456528;
  *(int *)((char *)&v20 + 2 * v10) = 3211330;
  *(int *)((char *)&v21 + 2 * v10) = 3145780;
  *(int *)((char *)&v22 + 2 * v10) = 4456494;
  *(int *)((char *)&v23 + 2 * v10) = 4980812;
  v24[v10] = 0;
  if ( !j___vcrt_LoadLibraryExW(&v16, 0, 2304) && GetLastError() == 87 )
    j___vcrt_LoadLibraryExW(&v16, 0, 8);
  return sub_41127B((unsigned int)&savedregs ^ v25);
}
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 4112D0: using guessed type int __thiscall sub_4112D0(_DWORD);
// 41135C: using guessed type int __cdecl j___vcrt_LoadLibraryExW(_DWORD, _DWORD, _DWORD);
// 418360: using guessed type wchar_t aApiMsWinCoreRe[36];
// 4183B8: using guessed type wchar_t aAdvapi32_dll[13];
// 418410: using guessed type wchar_t aSoftwareWow643[58];
// 41849C: using guessed type wchar_t aProductdir[11];
// 413EC0: using guessed type __int16 var_1EC[244];

//----- (00414140) --------------------------------------------------------
int __cdecl sub_414140(int a1, char a2)
{
  int v2; // edx@1
  int v3; // ecx@1
  int v4; // eax@1
  int v5; // edx@1
  int v6; // ecx@1
  char v8; // [sp+Ch] [bp-D8h]@1
  char *v9; // [sp+D0h] [bp-14h]@1

  memset(&v8, 0xCCu, 0xD8u);
  j_nullsub_1();
  v9 = &a2;
  _acrt_iob_func(0);
  v4 = sub_411127(v3, v2);
  sub_411398(v4, a1, 0, &a2);
  return sub_411127(v6, v5);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 4111D6: using guessed type int j_nullsub_1(void);
// 411398: using guessed type _DWORD __cdecl sub_411398(_DWORD, _DWORD, _DWORD, _DWORD);
// 41B17C: using guessed type int __cdecl _acrt_iob_func(_DWORD);

//----- (004141E0) --------------------------------------------------------
int __cdecl sub_4141E0(wchar_t *FullPath, wchar_t *PathResult, size_t SIZE)
{
  int result; // eax@2
  wchar_t Dir; // [sp+4h] [bp-60Ch]@1
  wchar_t Filename; // [sp+204h] [bp-40Ch]@1
  wchar_t Ext; // [sp+404h] [bp-20Ch]@1
  wchar_t Drive; // [sp+604h] [bp-Ch]@1
  int v8; // [sp+60Ch] [bp-4h]@2
  int savedregs; // [sp+610h] [bp+0h]@2

  if ( j__wsplitpath_s(FullPath, &Drive, 3u, &Dir, 0x100u, &Filename, 0x100u, &Ext, 0x100u)
    || j_wcscpy_s(&Filename, 9u, L"MSPDB140")
    || j_wcscpy_s(&Ext, 4u, L"DLL") )
  {
    result = sub_41127B((unsigned int)&savedregs ^ v8);
  }
  else
  {
    j__wmakepath_s(PathResult, SIZE, &Drive, &Dir, &Filename, &Ext);
    result = sub_41127B((unsigned int)&savedregs ^ v8);
  }
  return result;
}
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);

//----- (004142F0) --------------------------------------------------------
int __cdecl sub_4142F0(int a1, _WORD *a2, char a3, int *a4, int a5, int a6)
{
  int v7; // ecx@5
  char *v8; // ecx@6
  unsigned int v9; // esi@7
  unsigned int v10; // edi@7
  unsigned int v11; // ebx@7
  unsigned int v12; // eax@7
  int v13; // ecx@8
  int v14; // edx@9
  HMODULE v15; // eax@15
  FARPROC v16; // eax@18
  int (__cdecl *v17)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // esi@18
  int v18; // ST00_4@19
  _DWORD **v19; // edi@21
  int (__thiscall *v20)(_DWORD **, int, int); // esi@21
  _DWORD **v21; // edi@22
  int (__thiscall *v22)(_DWORD **, _DWORD, const char *, int *); // esi@22
  int v23; // edi@23
  unsigned int *v24; // ST10_4@23
  int (__thiscall *v25)(int, unsigned int *, unsigned int, int *, _DWORD, _DWORD, _DWORD); // esi@23
  int v26; // edi@24
  int (__thiscall *v27)(int, void (__thiscall ****)(_DWORD)); // esi@24
  unsigned int *v28; // edi@26
  int (__thiscall *v29)(_DWORD); // esi@26
  void (__thiscall ***v30)(_DWORD); // edi@27
  void (__thiscall *v31)(_DWORD); // esi@27
  void (__thiscall ***v32)(_DWORD); // edi@31
  int (__thiscall *v33)(_DWORD); // esi@31
  HANDLE v34; // eax@33
  void (__thiscall ***v35)(_DWORD); // edi@34
  void (__thiscall *v36)(_DWORD); // esi@34
  int v37; // edi@35
  void (__thiscall *v38)(int); // esi@35
  int v39; // edi@36
  void (__thiscall *v40)(int); // esi@36
  _DWORD **v41; // edi@37
  void (__thiscall *v42)(_DWORD); // esi@37
  SIZE_T v43; // ST24_4@40
  HANDLE v44; // eax@40
  unsigned int *v45; // eax@40
  void (__thiscall ***v46)(_DWORD); // edi@41
  unsigned int *v47; // ST24_4@41
  void (__thiscall *v48)(_DWORD); // esi@41
  char v49; // al@41
  unsigned int v50; // ebx@42
  unsigned int i; // eax@43
  int v52; // edi@46
  int (__thiscall *v53)(int, int, _WORD *, char *, _DWORD, _DWORD, _DWORD); // esi@46
  int v54; // ST10_4@46
  char v55; // al@46
  int v56; // [sp-8h] [bp-58h]@3
  int v57; // [sp-4h] [bp-54h]@3
  struct _MEMORY_BASIC_INFORMATION Buffer; // [sp+4h] [bp-4Ch]@1
  char v59; // [sp+20h] [bp-30h]@19
  int v60; // [sp+24h] [bp-2Ch]@41
  int v61; // [sp+28h] [bp-28h]@27
  int v62; // [sp+2Ch] [bp-24h]@21
  int v63; // [sp+30h] [bp-20h]@22
  unsigned int v64; // [sp+34h] [bp-1Ch]@27
  _DWORD **v65; // [sp+38h] [bp-18h]@19
  int v66; // [sp+3Ch] [bp-14h]@23
  unsigned int v67; // [sp+40h] [bp-10h]@27
  unsigned int *v68; // [sp+44h] [bp-Ch]@13
  void (__thiscall ***v69)(_DWORD); // [sp+48h] [bp-8h]@24
  unsigned __int16 v70; // [sp+4Ch] [bp-4h]@27

  *a4 = 0;
  *a2 = 0;
  if ( !VirtualQuery((LPCVOID)(a1 - 1), &Buffer, 0x1Cu) )
    return 0;
  if ( !j___vcrt_GetModuleFileNameW(Buffer.AllocationBase, a5, a6) )
    return 0;
  if ( *(_WORD *)Buffer.AllocationBase != 23117 )
    return 0;
  v7 = *((_DWORD *)Buffer.AllocationBase + 15);
  if ( v7 <= 0 )
    return 0;
  v8 = (char *)Buffer.AllocationBase + v7;
  if ( *(_DWORD *)v8 != 17744 )
    return 0;
  v9 = a1 - 1 - (unsigned int)Buffer.AllocationBase;
  v10 = *((_WORD *)v8 + 3);
  v11 = 0;
  v12 = 0;
  if ( *((_WORD *)v8 + 3) )
  {
    v13 = (int)&v8[*((_WORD *)v8 + 10) + 32];
    do
    {
      v14 = *(_DWORD *)(v13 + 4);
      if ( v9 >= v14 )
      {
        v11 = v9 - v14;
        if ( v9 < *(_DWORD *)v13 )
          break;
      }
      ++v12;
      v13 += 40;
    }
    while ( v12 < v10 );
  }
  if ( v12 == v10 )
    return 0;
  v68 = (unsigned int *)(v12 + 1);
  if ( byte_41A56D )
  {
    v15 = (HMODULE)dword_41A568;
  }
  else
  {
    if ( dword_41A568 )
      return 0;
    v15 = (HMODULE)sub_413D30();
    dword_41A568 = (int)v15;
    if ( !v15 )
      return 0;
    byte_41A56D = 1;
  }
  v16 = GetProcAddress(v15, "PDBOpenValidate5");
  v17 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v16;
  if ( !v16 )
    return 0;
  v18 = a5;
  sub_4112D0(v16);
  if ( !v17(v18, 0, 0, 0, &v59, 0, 0, &v65) )
    return 0;
  v19 = v65;
  v62 = 0;
  v20 = (int (__thiscall *)(_DWORD **, int, int))**v65;
  sub_4112D0(**v65);
  if ( v20(v19, v56, v57) == 20091201 )
  {
    v21 = v65;
    v22 = (int (__thiscall *)(_DWORD **, _DWORD, const char *, int *))(*v65)[7];
    sub_4112D0((*v65)[7]);
    if ( v22(v21, 0, "r", &v63) )
    {
      v23 = v63;
      v24 = v68;
      v25 = *(int (__thiscall **)(int, unsigned int *, unsigned int, int *, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v63 + 32);
      sub_4112D0(*(_DWORD *)(*(_DWORD *)v63 + 32));
      if ( v25(v23, v24, v11, &v66, 0, 0, 0) )
      {
        v26 = v66;
        v69 = 0;
        v27 = *(int (__thiscall **)(int, void (__thiscall ****)(_DWORD)))(*(_DWORD *)v66 + 104);
        sub_4112D0(*(_DWORD *)(*(_DWORD *)v66 + 104));
        if ( (unsigned __int8)v27(v26, &v69) && v69 )
        {
          v28 = 0;
          v29 = (int (__thiscall *)(_DWORD))(*v69)[2];
          sub_4112D0((*v69)[2]);
          if ( v29(v69) )
          {
            while ( 1 )
            {
              v30 = v69;
              v31 = (*v69)[3];
              sub_4112D0((*v69)[3]);
              if ( !(unsigned __int8)((int (__thiscall *)(void (__thiscall ***)(_DWORD), _DWORD, unsigned int *, unsigned __int16 *, int *, unsigned int *, _DWORD))v31)(
                                       v30,
                                       0,
                                       &v64,
                                       &v70,
                                       &v61,
                                       &v67,
                                       0) )
                break;
              if ( (unsigned int *)v70 == v68 && v64 <= v11 && v11 < v64 + v61 )
              {
                if ( !v67 )
                  break;
                if ( v67 >= 0x1FFFFFFF )
                  break;
                v43 = 8 * v67;
                v44 = GetProcessHeap();
                v45 = (unsigned int *)HeapAlloc(v44, 0, v43);
                v68 = v45;
                if ( !v45 )
                  break;
                v46 = v69;
                v47 = v45;
                v48 = (*v69)[3];
                sub_4112D0((*v69)[3]);
                v49 = ((int (__thiscall *)(void (__thiscall ***)(_DWORD), int *, _DWORD, _DWORD, _DWORD, unsigned int *, unsigned int *))v48)(
                        v46,
                        &v60,
                        0,
                        0,
                        0,
                        &v67,
                        v47);
                v28 = v68;
                if ( v49 )
                {
                  v50 = v11 - v64;
                  if ( v50 >= *v68 )
                  {
                    for ( i = 1; i < v67; ++i )
                    {
                      if ( v50 < v68[2 * i] )
                        break;
                    }
                    v52 = v66;
                    *a4 = v68[2 * i - 1] & 0xFFFFFF;
                    v53 = *(int (__thiscall **)(int, int, _WORD *, char *, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v52 + 112);
                    v54 = v60;
                    sub_4112D0(*(_DWORD *)(*(_DWORD *)v52 + 112));
                    v55 = v53(v52, v54, a2, &a3, 0, 0, 0);
                    v28 = v68;
                    if ( v55 )
                      v62 = 1;
                  }
                }
                goto LABEL_33;
              }
              v32 = v69;
              v33 = (int (__thiscall *)(_DWORD))(*v69)[2];
              sub_4112D0((*v69)[2]);
              if ( !v33(v32) )
              {
                v28 = 0;
                goto LABEL_33;
              }
            }
          }
          else
          {
LABEL_33:
            v34 = GetProcessHeap();
            HeapFree(v34, 0, v28);
          }
          v35 = v69;
          v36 = **v69;
          sub_4112D0(**v69);
          v36(v35);
        }
        v37 = v66;
        v38 = *(void (__thiscall **)(int))(*(_DWORD *)v66 + 64);
        sub_4112D0(*(_DWORD *)(*(_DWORD *)v66 + 64));
        v38(v37);
      }
      v39 = v63;
      v40 = *(void (__thiscall **)(int))(*(_DWORD *)v63 + 56);
      sub_4112D0(*(_DWORD *)(*(_DWORD *)v63 + 56));
      v40(v39);
    }
  }
  v41 = v65;
  v42 = (void (__thiscall *)(_DWORD))(*v65)[11];
  sub_4112D0((*v65)[11]);
  v42(v41);
  return v62;
}
// 4112D0: using guessed type int __thiscall sub_4112D0(_DWORD);
// 4112F3: using guessed type int __cdecl j___vcrt_GetModuleFileNameW(_DWORD, _DWORD, _DWORD);
// 41A568: using guessed type int dword_41A568;
// 41A56D: using guessed type char byte_41A56D;

//----- (00414640) --------------------------------------------------------
int sub_414640()
{
  int v0; // edx@4
  int v1; // ecx@4
  int v2; // edx@4
  int v3; // ecx@4
  char v5; // [sp+Ch] [bp-E0h]@1
  char Str1; // [sp+D0h] [bp-1Ch]@1
  unsigned int v7; // [sp+E8h] [bp-4h]@1
  int savedregs; // [sp+ECh] [bp+0h]@1

  memset(&v5, 0xCCu, 0xE0u);
  v7 = (unsigned int)&savedregs ^ __security_cookie;
  sub_411041();
  sub_411393("plz give me your name... \n");
  sub_411389("%18s", &Str1);
  if ( byte_41A000 )
    sub_4113A7(&Str1);
  else
    sub_4113A2(&Str1);
  system("pause");
  sub_411127(v1, v0);
  sub_411267(&savedregs, &dword_4146F8);
  sub_41127B((unsigned int)&savedregs ^ v7);
  return sub_411127(v3, v2);
}
// 411041: using guessed type int sub_411041(void);
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 411267: using guessed type int __fastcall sub_411267(_DWORD, _DWORD);
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 411389: using guessed type _DWORD sub_411389(const char *, ...);
// 411393: using guessed type _DWORD sub_411393(const char *, ...);
// 4146F8: using guessed type int dword_4146F8;
// 41A000: using guessed type char byte_41A000;

//----- (00414710) --------------------------------------------------------
int sub_414710()
{
  bool v5; // ST2B_1@2
  signed int v17; // [sp+18h] [bp-30h]@2
  int v18; // [sp+3Ch] [bp-Ch]@10
  int v19; // [sp+44h] [bp-4h]@0
  int savedregs; // [sp+48h] [bp+0h]@17

  dword_41A570 = 0;
  dword_41A030 |= 1u;
  if ( j_IsProcessorFeaturePresent(0xAu) )
  {
    dword_41A570 = 1;
    dword_41A030 |= 2u;
    _EAX = 0;
    __asm { cpuid }
    v17 = _EAX;
    v5 = (_ECX ^ 0x6C65746E | _EDX ^ 0x49656E69 | _EBX ^ 0x756E6547) == 0;
    _EAX = 1;
    __asm { cpuid }
    if ( v5
      && ((_EAX & 0xFFF3FF0) == 67264
       || (_EAX & 0xFFF3FF0) == 132704
       || (_EAX & 0xFFF3FF0) == 132720
       || (_EAX & 0xFFF3FF0) == 198224
       || (_EAX & 0xFFF3FF0) == 198240
       || (_EAX & 0xFFF3FF0) == 198256) )
    {
      dword_41A574 |= 1u;
    }
    v18 = _ECX;
    if ( v17 >= 7 )
    {
      _EAX = 7;
      __asm { cpuid }
      if ( _EBX & 0x200 )
        dword_41A574 |= 2u;
    }
    if ( v18 & 0x100000 )
    {
      dword_41A570 = 2;
      dword_41A030 |= 4u;
      if ( v18 & 0x8000000 )
      {
        if ( v18 & 0x10000000 )
          __asm { xgetbv }
      }
    }
  }
  return sub_41127B((unsigned int)&savedregs ^ v19);
}
// 41127B: using guessed type int __thiscall sub_41127B(_DWORD);
// 41A02C: using guessed type int dword_41A02C;
// 41A030: using guessed type int dword_41A030;
// 41A570: using guessed type int dword_41A570;
// 41A574: using guessed type int dword_41A574;

//----- (00414AA0) --------------------------------------------------------
BOOL sub_414AA0()
{
  return dword_41A034 != 0;
}
// 41A034: using guessed type int dword_41A034;

//----- (00414AD0) --------------------------------------------------------
void sub_414AD0()
{
  ;
}

//----- (00414AE0) --------------------------------------------------------
int __cdecl sub_414AE0(int a1)
{
  return *(_DWORD *)a1;
}

//----- (00414B00) --------------------------------------------------------
int __cdecl sub_414B00(int a1)
{
  return sub_4112E9(a1);
}
// 4112E9: using guessed type _DWORD __cdecl sub_4112E9(_DWORD);

//----- (00414CE0) --------------------------------------------------------
char sub_414CE0()
{
  return 1;
}

//----- (00414CF0) --------------------------------------------------------
char sub_414CF0()
{
  return 1;
}

//----- (00414D00) --------------------------------------------------------
char sub_414D00()
{
  return 1;
}

//----- (00414D10) --------------------------------------------------------
char sub_414D10()
{
  return 1;
}

//----- (00414D20) --------------------------------------------------------
char sub_414D20()
{
  return 1;
}

//----- (00414D30) --------------------------------------------------------
int sub_414D30()
{
  return 0;
}

//----- (00414D40) --------------------------------------------------------
int __cdecl sub_414D40(char *Str1)
{
  int v1; // edx@1
  int v2; // ecx@1
  int v3; // edx@2
  int v4; // ecx@2
  char v6; // [sp+Ch] [bp-C0h]@1

  memset(&v6, 0xCCu, 0xC0u);
  strncmp(Str1, "Reversing_is_C7H8", 0x12u);
  if ( sub_411127(v2, v1) )
    sub_411393("No No...");
  else
    sub_411217();
  return sub_411127(v4, v3);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 411217: using guessed type int sub_411217(void);
// 411393: using guessed type _DWORD sub_411393(const char *, ...);

//----- (00414EC0) --------------------------------------------------------
int __cdecl sub_414EC0(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int v5; // edx@1
  int v6; // ecx@1
  int v7; // edx@1
  int v8; // ecx@1
  char v10; // [sp+Ch] [bp-C0h]@1

  memset(&v10, 0xCCu, 0xC0u);
  v4 = sub_411348(a1, a2, a3, a4);
  _stdio_common_vfprintf(*(_DWORD *)v4, *(_DWORD *)(v4 + 4));
  sub_411127(v6, v5);
  return sub_411127(v8, v7);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 411348: using guessed type int __cdecl sub_411348(_DWORD, _DWORD, _DWORD, _DWORD);
// 41B178: using guessed type int __cdecl _stdio_common_vfprintf(_DWORD, _DWORD);

//----- (00414FF0) --------------------------------------------------------
int __fastcall sub_414FF0(int a1, int a2)
{
  int v2; // ST04_4@4
  int v3; // ecx@4
  char v5; // [sp+Ch] [bp-150h]@1
  int i; // [sp+D0h] [bp-8Ch]@1
  int v7; // [sp+DCh] [bp-80h]@1
  int v8; // [sp+E0h] [bp-7Ch]@1
  int v9; // [sp+E4h] [bp-78h]@1
  int v10; // [sp+E8h] [bp-74h]@1
  int v11; // [sp+ECh] [bp-70h]@1
  int v12; // [sp+F0h] [bp-6Ch]@1
  int v13; // [sp+F4h] [bp-68h]@1
  int v14; // [sp+F8h] [bp-64h]@1
  int v15; // [sp+FCh] [bp-60h]@1
  int v16; // [sp+100h] [bp-5Ch]@1
  int v17; // [sp+104h] [bp-58h]@1
  int v18; // [sp+108h] [bp-54h]@1
  int v19; // [sp+10Ch] [bp-50h]@1
  int v20; // [sp+110h] [bp-4Ch]@1
  int v21; // [sp+114h] [bp-48h]@1
  int v22; // [sp+118h] [bp-44h]@1
  int v23; // [sp+11Ch] [bp-40h]@1
  int v24; // [sp+120h] [bp-3Ch]@1
  int v25; // [sp+124h] [bp-38h]@1
  int v26; // [sp+128h] [bp-34h]@1
  int v27; // [sp+12Ch] [bp-30h]@1
  int v28; // [sp+130h] [bp-2Ch]@1
  int v29; // [sp+134h] [bp-28h]@1
  int v30; // [sp+138h] [bp-24h]@1
  int v31; // [sp+13Ch] [bp-20h]@1
  int v32; // [sp+140h] [bp-1Ch]@1
  int v33; // [sp+144h] [bp-18h]@1
  int v34; // [sp+148h] [bp-14h]@1
  int v35; // [sp+14Ch] [bp-10h]@1
  int v36; // [sp+150h] [bp-Ch]@1
  int v37; // [sp+154h] [bp-8h]@1
  int savedregs; // [sp+15Ch] [bp+0h]@4

  memset(&v5, 0xCCu, 0x150u);
  v7 = 102;
  v8 = 107;
  v9 = 95;
  v10 = 100;
  v11 = 119;
  v12 = 116;
  v13 = 105;
  v14 = 110;
  v15 = 87;
  v16 = 68;
  v17 = 107;
  v18 = 42;
  v19 = 104;
  v20 = 82;
  v21 = 84;
  v22 = 86;
  v23 = 79;
  v24 = 40;
  v25 = 30;
  v26 = 81;
  v27 = 75;
  v28 = 93;
  v29 = 29;
  v30 = 95;
  v31 = 77;
  v32 = 89;
  v33 = 27;
  v34 = 74;
  v35 = 86;
  v36 = 4;
  v37 = 95;
  for ( i = 0; i < 31; ++i )
    sub_411393("%c", i + *(&v7 + i));
  v2 = a2;
  sub_411267(&savedregs, &dword_415150);
  return sub_411127(v3, v2);
}
// 411127: using guessed type int __fastcall sub_411127(_DWORD, _DWORD);
// 411267: using guessed type int __fastcall sub_411267(_DWORD, _DWORD);
// 411393: using guessed type _DWORD sub_411393(const char *, ...);
// 415150: using guessed type int dword_415150;

#error "There were 5 decompilation failure(s) on 102 function(s)"
